(function(t){"use strict";var e,i=(t.BMP,{}),n={};i.createObjectURL=function(t,i){var r=e();
return!(!i||!i.autoRevoke)||!1,n[r]=t,"blob:"+r},i.revokeObjectURL=function(t){var e=t.replace("blob:","");
delete n[e]},i.retrieveObject=function(t){var e=t.replace("blob:","");return n[e]
},i.revokeAllObjectURLs=function(){n={}},e=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=0|16*Math.random(),i="x"===t?e:8|3&e;
return i.toString(16)})},t.BMP=t.BMP||{},t.BMP.URL=i})(this),function(t){"use strict";
var e,i;t.BMP=t.BMP||{},e=t.BMP,e.MIME=e.MIME||{},i=e.MIME,i.TEXT_TYPES=["application/javascript","application/json","application/x-javascript"],i.isText=function(t){return 0===t.indexOf("text/")?!0:-1!==i.TEXT_TYPES.indexOf(t)?!0:!1
}}(this),function(t){"use strict";var e,i,n,r,o=!0,s=t.BMP.MIME;try{e=new t.Blob,e=null
}catch(a){o=!1}r=function(e){var i,n="",r=new t.Uint8Array(e),o=r.byteLength;for(i=0;o>i;i++)n+=String.fromCharCode(r[i]);
return t.btoa(n)},i=function(t,e){var i;if(t&&!Array.isArray(t))throw Error("first argument should be an Array");
return e=e||{},this.size=0,this.type="",this.base64="",this.text="","object"==typeof e&&(this.type=e.type||this.type),t&&t.length&&(i=t[0],"string"==typeof i&&(0===i.indexOf("data:")&&"text/plain"===this.type?(this.size+=i.length,this.text+=i):(this.size+=i.length,this.base64+=i))),this
},i.createNative=function(e,n){var r;return n=n||{},o?new t.Blob(e,n):t.BlobBuilder?(r=new t.BlobBuilder,r.append(e),r.getBlob(n)):new i(e,n)
},i.fromBlobURL=function(e,n,r){n=n||function(){},r=r||function(){},t.URL&&t.URL.createObjectURL?i.nativelyFromBlobURL(e,n,r):this.fromNativeBlob(t.BMP.URL.retrieveObject(e),function(t){n(t)
},function(t){r(t)})},i.fromNativeBlob=function(e,n,r){var o=new t.FileReader;n=n||function(){},r=r||function(){},o.onload=function(t){var s;
o.onload=null;try{if(s=t.target.result,e=i.fromDataURI(t.target.result),!e)throw Error("Blob.fromNativeBlob: fromDataURI gave no blob")
}catch(a){return r(a),void 0}n(e)},o.onerror=function(t){o.onerror=null,r(t.target.error)
};try{o.readAsDataURL(e)}catch(s){o.onload=null,o.onerror=null,r(s)}},i.fromDataURI=function(e){var n,r,o,s,a=new i;
n=e.split(","),s=n[1],n=n[0].split(":"),n=n[1].split(";"),r=n[0],o=n[1],"base64"===o?a.base64=s:a.text=s,a.type=r,a.size=s.length;
try{a=i.fromDataURI(t.atob(a.base64)),a.makeNested()}catch(l){}return a},i.prototype.toDataURI=function(){var t,e;
return t="data:"+this.type,this.base64?(t+=";base64,",e=t+this.base64):(t+=",",e=t+this.text),e
},i.nativelyFromBlobURL=function(e,n,o){var s,a;n=n||function(){},o=o||function(){},s=new t.XMLHttpRequest,s.onreadystatechange=function(){var e,s,l;
this.readyState===t.XMLHttpRequest.DONE&&(this.onreadystatechange=null,e=this.getResponseHeader("Content-Type"),200===this.status?("arraybuffer"===this.responseType?(s=r(this.response),a=new i([s],{type:e})):"blob"===this.responseType?i.fromNativeBlob(this.response,function(t){n(t)
},function(t){o(t)}):"document"===this.responseType?(l=new t.XMLSerializer,s=t.btoa(l.serializeToString(this.response)),a=new i([s],{type:e})):"json"===this.responseType?(s=t.btoa(JSON.stringify(this.response)),a=new i([s],{type:e})):a=new i([this.response],{type:e}),a?n(a):o(Error("error retrieving target Blob via Blob URL"))):o(Error(this.url+" -> "+this.status)))
},s.open("GET",e),s.send()},i.isNested=function(){},i.prototype.decode64=function(){!this.text&&this.base64&&s.isText(this.type)&&(this.text=t.atob(this.base64),this.base64=null)
},i.prototype.encode64=function(){this.text&&!this.base64&&(this.base64=t.btoa(this.text),this.text=null)
},i.prototype.makeNested=function(){var t="data:";t+=this.type,t+=";base64,",t+=this.base64,this.type="text/plain",this.text=t,this.base64=null
},i.prototype.undoNested=function(){var t=i.fromDataURI(this.text);this.type=t.type,this.base64=t.base64,this.text=null
},i.prototype.toNative=function(){return t.BMP.Blob.createNative([t.atob(this.base64)],{type:this.type})
},t.BMP=t.BMP||{},t.BMP.Blob=i,t.BMP.NestedBlob=n}(this),function(t){"use strict";
var e,i;t.BMP=t.BMP||{},e=t.BMP,i=function(t){if(t instanceof $&&1===t.length)this.$el=t,this.el=this.$el[0];
else{if(!_.isElement(t))throw Error("BMP.FileInput constructor expects a single DOM Element");
this.el=t,this.$el=$(this.el)}return this},i.prototype.size=function(){return this.el&&this.$el.val()&&this.el.files?this.el.files.length:0
},i.prototype.getNativeBlob=function(t){var e;if(t&&_.isNumber(t)||(t=0),e=this.size(),t>=e)throw new RangeError("targetIndex: "+t+"; size:"+e);
return this.el.files[t]},i.prototype.getBlob=function(t){var i=new $.Deferred;return e.Blob.fromNativeBlob(this.getNativeBlob(t),function(t){i.resolve(t)
},i.reject),i.promise()},i.initialize=function(){$(document.body).on("click","input[type=file]",i.onClick)
},i.onClick=function(){var t=$(this);t.data("fileInput")||t.data("fileInput",new i(this))
},e.FileInput=i}(this);
//@ sourceMappingURL=bmp-blobs.js.map